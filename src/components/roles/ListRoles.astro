---
import { Icon } from "astro-icon/components";
const usuarios = [
  { id: 1, name: 'Carlos Lopez', email: 'carlo@gemail.com', role: 'estudiante', role_status: 'Activo'},
  { id: 2, name: 'Laura Pe√±a', email: 'penna@gemail.com', role: 'administrador', role_status: 'Activo'},
  { id: 3, name: 'Juan Martinez', email: 'juan@gemail.com', role: 'estudiante', role_status: 'Desactivado' },
];

// import axios from "axios";
// let usuarios = [];
// await axios
//     .get(`${import.meta.env.API_URL}user`)
//     .then(function (response) {
//         usuarios = response.data;
//     })
//     .catch(function (error) {
//         console.log(error);
//     });

const roles = ["Estudiante", "Administrador", "Docente"];

const isAuthenticated = true;
const hasPermission = true;
---

<div class="container p-2">
    <div class="title text-3xl mb-5">
        <h3>Roles de usuarios</h3>
    </div>
    <div class="mb-5 w-1/2">
        <label for="role" class="text-gray-700 font-semibold"
            >Filtrar por rol:</label
        >
        <select
            id="role"
            class="ml-3 px-4 py-2 border w-3/4 border-gray-300 rounded-md focus:ring focus:ring-emerald-300"
            x-model="selectedRole"
        >
            {roles.map((role) => <option value={role}>{role}</option>)}
        </select>
    </div>
    <ul
        class="bg-white shadow-sm ring-1 ring-gray-900/5 sm:rounded-xl"
    >
        {
            usuarios.length > 0 ? (
                usuarios.map(({ id, name, email, role, role_status }) => (
                    <li class="flex justify-center items-center gap-x-2 px-2 py-1 hover:bg-gray-50 sm:px-6 ">
                        <div class=" grid grid-cols-4  flex-auto text-sm">
                            <p class="font-semibold text-gray-900 ">
                                {name}
                            </p>
                            <p class="text-gray-600">{email}</p>
                            <p class="text-gray-600">{role}</p>
                            <p class="text-gray-600">{role_status}</p>
                        </div>

                        {isAuthenticated && hasPermission ? (
                            <div
                                class="flex justify-end items-center"
                                x-data="{isListOptionsMenuOpen: false}"
                            >
                                <div class="relative flex-none">
                                    <button
                                        class="-m-5.5 block p-2.5 text-gray-500 hover:text-gray-900"
                                        type="button"
                                        @click="isListOptionsMenuOpen = !isListOptionsMenuOpen"
                                    >
                                        <Icon
                                            class="h-5 w-5"
                                            name="shared/ellipsis-vertical"
                                        />
                                    </button>
                                    <div
                                        class="absolute right-0 z-10 mt-2 w-32 origin-top-right rounded-md bg-white py-2 shadow-lg ring-1 ring-gray-900/5 focus:outline-none"
                                        tabindex="-1"
                                        x-show="isListOptionsMenuOpen"
                                        @click.outside="isListOptionsMenuOpen = false"
                                    >
                                        <a
                                            href="#"
                                            class="block px-3 py-1 text-sm leading-6 text-gray-900 hover:bg-gray-50"
                                            tabindex="-1"
                                            @click.prevent={`isUpdateWindowOpen = true; selectedProcess = '${id}';`}
                                        >
                                            Editar
                                        </a>
                                        <a
                                            href="#"
                                            class="block px-3 py-1 text-sm leading-6 text-gray-900 hover:bg-gray-50"
                                            tabindex="-1"
                                            @click.prevent={`isDeleteWindowOpen = true; selectedProcess = '${id}'; console.log('Proceso ID para eliminar:', '${id}')`}
                                        >
                                            Eliminar
                                        </a>
                                    </div>
                                </div>
                            </div>
                        ) : null}
                    </li>
                ))
            ) : (
                <li class="text-gray-600 p-4">No hay procesos disponibles.</li>
            )
        }
    </ul>
</div>
