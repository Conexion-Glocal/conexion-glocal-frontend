---
import { Icon } from "astro-icon/components";
import axios from "axios";
let getPublicConvocation = [];
await axios
  .get(`${import.meta.env.API_URL}processes`)
  .then(function (response) {
    getPublicConvocation = response.data;
  })
  .catch(function (error) {
    console.log(error);
  });
---
<ul
  class="divide-y divide-gray-100 bg-white shadow-sm ring-1 ring-gray-900/5 sm:rounded-xl"
>
  {
    getPublicConvocation
      ? getPublicConvocation.map(({ id, name, form_id }) => (
          <li class="relative flex justify-between gap-x-6 px-4 py-5 hover:bg-gray-50 sm:px-6">
            <div class="flex min-w-0 gap-x-4">
              <div class="min-w-0 flex-auto">
                <p class="text-sm font-semibold leading-6 text-gray-900">
                  <a href="#">
                    <span class="absolute inset-x-0 -top-px bottom-0" />
                    {name}
                  </a>
                </p>
                <p class="mt-1 flex text-xs leading-5 text-gray-500">
                  Ofertas: 1
                </p>
              </div>
              <div class="min-w-0 flex-auto">
                <p class="mt-1 flex text-xs leading-5 text-gray-500">
                  <a href="#">
                    <span class="absolute inset-x-0 -top-px bottom-0" />
                    Fecha de inicio: 17/05/20
                  </a>
                </p>
                <p class="mt-1 flex text-xs leading-5 text-gray-500">
                  Fecha de cierre: 17/50/20
                </p>
              </div>
            </div>
            <div
              class="flex flex-none items-center gap-x-4"
              x-data="{isListOptionsMenuOpen: false}">
                      <a class="rounded-md bg-[#E5BE01] px-2.5 py-1.5 text-sm font-semibold text-white hover:bg-[#064E3B] sm:block">Ver detalles</a>
                      <button class="rounded-md bg-[#047857] px-2.5 py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-[#064E3B] sm:block">Postularse</button>
              <div class="relative flex-none">
                <button
                  class="-m-2.5 block p-2.5 text-gray-500 hover:text-gray-900"
                  type="button"
                  @click="isListOptionsMenuOpen = ! isListOptionsMenuOpen"
                >
                  <Icon class="h-5 w-5" name="shared/ellipsis-vertical" />
                </button>
                <div
                  class="absolute right-0 z-10 mt-2 w-32 origin-top-right rounded-md bg-white py-2 shadow-lg ring-1 ring-gray-900/5 focus:outline-none"
                  tabindex="-1"
                  x-show="isListOptionsMenuOpen"
                  @click.outside="isListOptionsMenuOpen = false"
                >
                  <a
                    href="#"
                    class="block px-3 py-1 text-sm leading-6 text-gray-900 hover:bg-gray-50"
                    tabindex="-1"
                    @click.prevent={`isUpdateWindowOpen = true;'; id = '${id}'; name = '${name}';`}
                  >
                    Editar
                  </a>
                  <a
                    href="#"
                    class="block px-3 py-1 text-sm leading-6 text-gray-900 hover:bg-gray-50"
                    tabindex="-1"
                    @click.prevent={`isDeleteWindowOpen = true; id = '${id}'`}
                  >
                    Eliminar
                  </a>
                </div>
              </div>
            </div>
          </li>
        ))
      : ""
  }
</ul>
